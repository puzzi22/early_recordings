!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.Blazy=e()}(this,(function(){"use strict";var t,e,o,n,s="srcset";return function(s){if(!document.querySelectorAll){var c=document.createStyleSheet();document.querySelectorAll=function(t,e,o,n,s){for(s=document.all,e=[],o=(t=t.replace(/\[for\b/gi,"[htmlFor").split(",")).length;o--;){for(c.addRule(t[o],"k:v"),n=s.length;n--;)s[n].currentStyle.k&&e.push(s[n]);c.removeRule(0)}return e}}var a=this,f=a._util={};f.elements=[],f.destroyed=!0,a.options=s||{},a.options.error=a.options.error||!1,a.options.offset=a.options.offset||100,a.options.root=a.options.root||document,a.options.success=a.options.success||!1,a.options.selector=a.options.selector||".b-lazy",a.options.separator=a.options.separator||"|",a.options.containerClass=a.options.container,a.options.container=!!a.options.containerClass&&document.querySelectorAll(a.options.containerClass),a.options.errorClass=a.options.errorClass||"b-error",a.options.breakpoints=a.options.breakpoints||!1,a.options.loadInvisible=a.options.loadInvisible||!1,a.options.successClass=a.options.successClass||"b-loaded",a.options.validateDelay=a.options.validateDelay||25,a.options.saveViewportOffsetDelay=a.options.saveViewportOffsetDelay||50,a.options.srcset=a.options.srcset||"data-srcset",a.options.src=t=a.options.src||"data-src",n=Element.prototype.closest,o=window.devicePixelRatio>1,(e={}).top=0-a.options.offset,e.left=0-a.options.offset,a.revalidate=function(){i(a)},a.load=function(t,e){var o=this.options;t&&void 0===t.length?l(t,e,o):E(t,(function(t){l(t,e,o)}))},a.destroy=function(){var t=a._util;a.options.container&&E(a.options.container,(function(e){C(e,"scroll",t.validateT)})),C(window,"scroll",t.validateT),C(window,"resize",t.validateT),C(window,"resize",t.saveViewportOffsetT),t.count=0,t.elements.length=0,t.destroyed=!0},f.validateT=T((function(){r(a)}),a.options.validateDelay,a),f.saveViewportOffsetT=T((function(){y(a.options.offset)}),a.options.saveViewportOffsetDelay,a),y(a.options.offset),E(a.options.breakpoints,(function(e){if(e.width>=window.screen.width)return t=e.src,!1})),setTimeout((function(){i(a)}))};function i(t){var e=t._util;e.elements=function(t){for(var e=[],o=t.root.querySelectorAll(t.selector),n=o.length;n--;e.unshift(o[n]));return e}(t.options),e.count=e.elements.length,e.destroyed&&(e.destroyed=!1,t.options.container&&E(t.options.container,(function(t){b(t,"scroll",e.validateT)})),b(window,"resize",e.saveViewportOffsetT),b(window,"resize",e.validateT),b(window,"scroll",e.validateT)),r(t)}function r(t){for(var e=t._util,o=0;o<e.count;o++){var n=e.elements[o];(c(n,t.options)||g(n,t.options.successClass))&&(t.load(n),e.elements.splice(o,1),e.count--,o--)}0===e.count&&t.destroy()}function c(t,o){var s=t.getBoundingClientRect();if(o.container&&n){var i=t.closest(o.containerClass);if(i){var r=i.getBoundingClientRect();if(a(r,e)){var c=r.top-o.offset,l=r.right+o.offset,f=r.bottom+o.offset,u=r.left-o.offset;return a(s,{top:c>e.top?c:e.top,right:l<e.right?l:e.right,bottom:f<e.bottom?f:e.bottom,left:u>e.left?u:e.left})}return!1}}return a(s,e)}function a(t,e){return t.right>=e.left&&t.bottom>=e.top&&t.left<=e.right&&t.top<=e.bottom}function l(e,n,i){if(!g(e,i.successClass)&&(n||i.loadInvisible||e.offsetWidth>0&&e.offsetHeight>0)){var r=v(e,t)||v(e,i.src);if(r){var c=r.split(i.separator),a=c[o&&c.length>1?1:0],l=v(e,i.srcset),d=h(e,"img"),m=e.parentNode,y=m&&h(m,"picture");if(d||void 0===e.src){var T=new Image,k=function(){i.error&&i.error(e,"invalid"),w(e,i.errorClass),C(T,"error",k),C(T,"load",A)},A=function(){d?y||p(e,a,l):e.style.backgroundImage='url("'+a+'")',f(e,i),C(T,"load",A),C(T,"error",k)};y&&(T=e,E(m.getElementsByTagName("source"),(function(t){u(t,s,i.srcset)}))),b(T,"error",k),b(T,"load",A),p(T,a,l)}else e.src=a,f(e,i)}else h(e,"video")?(E(e.getElementsByTagName("source"),(function(t){u(t,"src",i.src)})),e.load(),f(e,i)):(i.error&&i.error(e,"missing"),w(e,i.errorClass))}}function f(t,e){w(t,e.successClass),e.success&&e.success(t),m(t,e.src),m(t,e.srcset),E(e.breakpoints,(function(e){m(t,e.src)}))}function u(t,e,o){var n=v(t,o);n&&(d(t,e,n),m(t,o))}function p(t,e,o){o&&d(t,s,o),t.src=e}function d(t,e,o){t.setAttribute(e,o)}function v(t,e){return t.getAttribute(e)}function m(t,e){t.removeAttribute(e)}function h(t,e){return t.nodeName.toLowerCase()===e}function g(t,e){return-1!==(" "+t.className+" ").indexOf(" "+e+" ")}function w(t,e){g(t,e)||(t.className+=" "+e)}function y(t){e.bottom=(window.innerHeight||document.documentElement.clientHeight)+t,e.right=(window.innerWidth||document.documentElement.clientWidth)+t}function b(t,e,o){t.attachEvent?t.attachEvent&&t.attachEvent("on"+e,o):t.addEventListener(e,o,{capture:!1,passive:!0})}function C(t,e,o){t.detachEvent?t.detachEvent&&t.detachEvent("on"+e,o):t.removeEventListener(e,o,{capture:!1,passive:!0})}function E(t,e){if(t&&e)for(var o=t.length,n=0;n<o&&!1!==e(t[n],n);n++);}function T(t,e,o){var n=0;return function(){var s=+new Date;s-n<e||(n=s,t.apply(o,arguments))}}}));
//# sourceMappingURL=vuillermoz.578a1857.js.map
